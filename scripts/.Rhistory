(plot_C_foliar <- ggplot(data = data, aes(x = Site, y = C_foliar)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = C_foliar_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Foliar Carbon (g g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### N_foliar
N_foliar_lm <- lm(as.formula(paste(dep_variables[8],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(N_foliar_lm) ~ fitted(N_foliar_lm))
anova(N_foliar_lm)
cld.emmGrid(emmeans(N_foliar_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
N_foliar_letters <- letters(dfy = data$N_foliar, y = "N_foliar")
(plot_N_foliar <- ggplot(data = data, aes(x = Site, y = N_foliar)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = N_foliar_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Foliar Nitrogen (g g"^{-1}*")")) +
# theme(legend.position = "bottom", legend.title = element_text(size = 16),
#       legend.text = element_text(size = 12)) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### CN_foliar
CN_foliar_lm <- lm(as.formula(paste(dep_variables[9],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(CN_foliar_lm) ~ fitted(CN_foliar_lm))
anova(CN_foliar_lm)
cld.emmGrid(emmeans(CN_foliar_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
CN_foliar_letters <- letters(dfy = data$CN_foliar, y = "CN_foliar")
(plot_CN_foliar <- ggplot(data = data, aes(x = Site, y = CN_foliar)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = CN_foliar_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
scale_y_continuous(name = "Foliar Carbon/Nitrogen") +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
(plots_foliar_organics <- plot_C_foliar + plot_N_foliar + plot_CN_foliar +
plot_layout(guides = 'collect') +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
## foliar inorganics
### Ca_foliar
Ca_foliar_lm <- lm(as.formula(paste(dep_variables[10],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(Ca_foliar_lm) ~ fitted(Ca_foliar_lm))
anova(Ca_foliar_lm)
cld.emmGrid(emmeans(Ca_foliar_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
Ca_foliar_letters <- letters(dfy = data$Ca_foliar, y = "Ca_foliar")
(plot_Ca_foliar <- ggplot(data = data, aes(x = Site, y = Ca_foliar)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = Ca_foliar_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Foliar Calcium (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### P_foliar
P_foliar_lm <- lm(as.formula(paste(dep_variables[11],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(P_foliar_lm) ~ fitted(P_foliar_lm))
anova(P_foliar_lm)
cld.emmGrid(emmeans(P_foliar_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
P_foliar_letters <- letters_adj(dfy = data$P_foliar, y = "P_foliar", adjy = "log(P_foliar)")
(plot_P_foliar <- ggplot(data = data, aes(x = Site, y = P_foliar)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = P_foliar_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Foliar Phosphorus (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### K_foliar
K_foliar_lm <- lm(as.formula(paste(dep_variables[12],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(K_foliar_lm) ~ fitted(K_foliar_lm))
anova(K_foliar_lm)
cld.emmGrid(emmeans(K_foliar_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
K_foliar_letters <- letters_adj(dfy = data$K_foliar, y = "K_foliar", adjy = "log(K_foliar)")
(plot_K_foliar <- ggplot(data = data, aes(x = Site, y = K_foliar)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = K_foliar_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Foliar Potassium (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### Mg_foliar
Mg_foliar_lm <- lm(as.formula(paste(dep_variables[13],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(Mg_foliar_lm) ~ fitted(Mg_foliar_lm))
anova(Mg_foliar_lm)
cld.emmGrid(emmeans(Mg_foliar_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
Mg_foliar_letters <- letters(dfy = data$Mg_foliar, y = "Mg_foliar")
(plot_Mg_foliar <- ggplot(data = data, aes(x = Site, y = Mg_foliar)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = Mg_foliar_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Foliar Magnesium (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### Al_foliar
Al_foliar_lm <- lm(as.formula(paste(dep_variables[14],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(Al_foliar_lm) ~ fitted(Al_foliar_lm))
anova(Al_foliar_lm)
cld.emmGrid(emmeans(Al_foliar_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
Al_foliar_letters <- letters(dfy = data$Al_foliar, y = "Al_foliar")
(plot_Al_foliar <- ggplot(data = data, aes(x = Site, y = Al_foliar)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = Al_foliar_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Foliar Aluminum (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### Zn_foliar
Zn_foliar_lm <- lm(as.formula(paste(dep_variables[15],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(Zn_foliar_lm) ~ fitted(Zn_foliar_lm))
anova(Zn_foliar_lm)
cld.emmGrid(emmeans(Zn_foliar_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
Zn_foliar_letters <- letters_adj(dfy = data$Zn_foliar, y = "Zn_foliar", adjy = "log(Zn_foliar)")
(plot_Zn_foliar <- ggplot(data = data, aes(x = Site, y = Zn_foliar)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = Zn_foliar_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Foliar Zinc (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
(plots_foliar_inorganics <- plot_Ca_foliar + plot_P_foliar + plot_K_foliar +
plot_Mg_foliar + plot_Al_foliar + plot_Zn_foliar +
plot_layout(guides = 'collect') +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
## foliar isotopes
### d13C
d13C_lm <- lm(as.formula(paste(dep_variables[5],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(d13C_lm) ~ fitted(d13C_lm))
anova(d13C_lm)
cld.emmGrid(emmeans(d13C_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot - not using function because of negative data
d13C_abs_max <- max(data$d13C, na.rm = TRUE)
d13C_letters <- data %>% group_by(Site) %>%
summarise(yaxis = max(d13C, na.rm = TRUE) - 0.02 * d13C_abs_max) # get the highest point for each species
d13C_hsd <- HSD.test(aov(d13C ~ Site, data), "Site", group = TRUE) # get Tukey HSD results
d13C_letters$groups <- d13C_hsd$groups$groups
(plot_d13C <- ggplot(data = data, aes(x = Site, y = d13C)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = d13C_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression(delta^{"13"}*"C (‰)")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### d15N
d15N_lm <- lm(as.formula(paste(dep_variables[6],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(d15N_lm) ~ fitted(d15N_lm))
anova(d15N_lm)
cld.emmGrid(emmeans(d15N_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
d15N_letters <- letters(dfy = data$d15N, y = "d15N")
(plot_d15N <- ggplot(data = data, aes(x = Site, y = d15N)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = d15N_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression(delta^{"15"}*"N (‰)")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
(plots_foliar_isotopes <- plot_d13C + plot_d15N +
plot_layout(guides = 'collect') +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
## soil organics
### C_soil
C_soil_lm <- lm(as.formula(paste(dep_variables[24],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(C_soil_lm) ~ fitted(C_soil_lm))
anova(C_soil_lm)
cld.emmGrid(emmeans(C_soil_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
C_soil_letters <- letters(dfy = data$C_soil, y = "C_soil")
(plot_C_soil <- ggplot(data = data, aes(x = Site, y = C_soil)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = C_soil_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Soil Carbon (g g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### N_soil
N_soil_lm <- lm(as.formula(paste(dep_variables[25],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(N_soil_lm) ~ fitted(N_soil_lm))
anova(N_soil_lm)
cld.emmGrid(emmeans(N_soil_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
N_soil_letters <- letters(dfy = data$N_soil, y = "N_soil")
(plot_N_soil <- ggplot(data = data, aes(x = Site, y = N_soil)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = N_soil_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Soil Nitrogen (g g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### CN_soil
CN_soil_lm <- lm(as.formula(paste(dep_variables[26],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(CN_soil_lm) ~ fitted(CN_soil_lm))
anova(CN_soil_lm)
cld.emmGrid(emmeans(CN_soil_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
CN_soil_letters <- letters_adj(dfy = data$CN_soil, y = "CN_soil", adjy = "log(CN_soil)")
(plot_CN_soil <- ggplot(data = data, aes(x = Site, y = CN_soil)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = CN_soil_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
scale_y_continuous(name = "Soil Carbon/Nitrogen") +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
(plots_soil_organics <- plot_C_soil + plot_N_soil + plot_CN_soil +
plot_layout(guides = 'collect') +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
## soil inorganics
### Ca_soil
Ca_soil_lm <- lm(as.formula(paste(dep_variables[16],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(Ca_soil_lm) ~ fitted(Ca_soil_lm))
anova(Ca_soil_lm)
cld.emmGrid(emmeans(Ca_soil_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
Ca_soil_letters <- letters(dfy = data$Ca_soil, y = "Ca_soil")
(plot_Ca_soil <- ggplot(data = data, aes(x = Site, y = Ca_soil)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = Ca_soil_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Soil Calcium (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### P_soil
P_soil_lm <- lm(as.formula(paste(dep_variables[17],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(P_soil_lm) ~ fitted(P_soil_lm))
anova(P_soil_lm)
cld.emmGrid(emmeans(P_soil_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
P_soil_letters <- letters_adj(dfy = data$P_soil, y = "P_soil", adjy = "log(P_soil)")
(plot_P_soil <- ggplot(data = data, aes(x = Site, y = P_soil)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = P_soil_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Soil Phosphorus (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### K_soil
K_soil_lm <- lm(as.formula(paste(dep_variables[18],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(K_soil_lm) ~ fitted(K_soil_lm))
anova(K_soil_lm)
cld.emmGrid(emmeans(K_soil_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
K_soil_letters <- letters(dfy = data$K_soil, y = "K_soil")
(plot_K_soil <- ggplot(data = data, aes(x = Site, y = K_soil)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = K_soil_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Soil Potassium (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### Mg_soil
Mg_soil_lm <- lm(as.formula(paste(dep_variables[19],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(Mg_soil_lm) ~ fitted(Mg_soil_lm))
anova(Mg_soil_lm)
cld.emmGrid(emmeans(Mg_soil_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
Mg_soil_letters <- letters(dfy = data$Mg_soil, y = "Mg_soil")
(plot_Mg_soil <- ggplot(data = data, aes(x = Site, y = Mg_soil)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = Mg_soil_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Soil Magnesium (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### Al_soil
Al_soil_lm <- lm(as.formula(paste(dep_variables[20],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(Al_soil_lm) ~ fitted(Al_soil_lm))
anova(Al_soil_lm)
cld.emmGrid(emmeans(Al_soil_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
Al_soil_letters <- letters_adj(dfy = data$Al_soil, y = "Al_soil", adjy = "log(Al_soil)")
(plot_Al_soil <- ggplot(data = data, aes(x = Site, y = Al_soil)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = Al_soil_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Soil Aluminum (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### Zn_soil
Zn_soil_lm <- lm(as.formula(paste(dep_variables[21],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(Zn_soil_lm) ~ fitted(Zn_soil_lm))
anova(Zn_soil_lm)
cld.emmGrid(emmeans(Zn_soil_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
Zn_soil_letters <- letters_adj(dfy = data$Zn_soil, y = "Zn_soil", adjy = "log(Zn_soil)")
(plot_Zn_soil <- ggplot(data = data, aes(x = Site, y = Zn_soil)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = Zn_soil_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Soil Zinc (mg g"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
(plots_soil_inorganics <- plot_Ca_soil + plot_P_soil + plot_K_soil +
plot_Mg_soil + plot_Al_soil + plot_Zn_soil +
plot_layout(guides = "collect") +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
## soil characteristics
### pH
pH_lm <- lm(as.formula(paste(dep_variables[22],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(pH_lm) ~ fitted(pH_lm))
anova(pH_lm)
cld.emmGrid(emmeans(pH_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
pH_letters <- letters(dfy = data$pH, y = "pH")
(plot_pH <- ggplot(data = data, aes(x = Site, y = pH)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = pH_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
scale_y_continuous(name = "Soil pH") +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
### CEC
CEC_lm <- lm(as.formula(paste(dep_variables[23],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(CEC_lm) ~ fitted(CEC_lm))
anova(CEC_lm)
cld.emmGrid(emmeans(CEC_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
CEC_letters <- letters(dfy = data$CEC, y = "CEC")
(plot_CEC <- ggplot(data = data, aes(x = Site, y = CEC)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = CEC_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
ylab(expression("Soil CEC (cmol"[c]*" kg"^{-1}*")")) +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
## soil characteristics
### retention
retention_lm <- lm(as.formula(paste(dep_variables[27],
paste(ind_variables, collapse = "*"),
sep = "~")), data = data)
#plot(resid(retention_lm) ~ fitted(retention_lm))
anova(retention_lm)
cld.emmGrid(emmeans(retention_lm, ~elevation_fac * fire))
#### get pairwise letters for boxplot
retention_letters <- letters_adj(dfy = data$Retention, y = "Retention", adjy = "asin(sqrt(0.01 * Retention))")
(plot_retention <- ggplot(data = data, aes(x = Site, y = Retention)) +
geom_rect(data = NULL, aes(xmin = 0, xmax = 2.5, ymin = -Inf, ymax = Inf),
fill = "grey") +
geom_jitter(height = 0, aes(color = fire, shape = elevation_fac), size = 2) +
scale_color_manual(values = c('red', 'blue')) +
geom_boxplot(outlier.color = NA, fill = NA) +
geom_text(data = retention_letters, aes(y = yaxis, label = groups)) +
theme_few(base_size = 16) +
scale_x_discrete(name = "Site", limits = c("WON", "GOR", "STS", "SCT")) +
scale_y_continuous(name = "Soil Water Retention (%)") +
guides(color = guide_legend("Fire History")) +
guides(shape = guide_legend("Elevation")))
(plots_soil_characteristics <- plot_retention + plot_CEC + plot_pH +
plot_layout(guides = "collect", ncol = 3, nrow = 1) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 16)))
